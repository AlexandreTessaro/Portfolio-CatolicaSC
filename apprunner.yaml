version: 1.0
runtime: docker
build:
  commands:
    build:
      - echo "Building Docker image..."
      - docker build -t startup-collab-backend -f backend/Dockerfile .
run:
  runtime-version: latest
  command: npm start
  network:
    port: 5000
    env: PORT
  env:
    - name: NODE_ENV
      value: production
    - name: PORT
      value: "5000"
    # Configure estas variáveis no console da AWS App Runner:
    # - DATABASE_URL (PostgreSQL RDS connection string)
    # - JWT_SECRET (gere: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))")
    # - JWT_REFRESH_SECRET (gere outro secret forte)
    # - FRONTEND_URL (URL do CloudFront/S3 do frontend)
    # - REDIS_ENABLED (true/false)
    # - REDIS_URL (se usar ElastiCache)
    # - MIGRATION_TOKEN (token para executar migrações)
    # - BCRYPT_SALT_ROUNDS (12)
    # - SMTP_HOST, SMTP_PORT, SMTP_USER, SMTP_PASS (opcional)


